{"layout":"post-content","title":"mssql 쿼리 팁 - 여러 행의 데이터를 한 칼럼에 담기","date":"2018-01-26T00:00:00.000Z","tags":["mssql"],"category":["sql"],"body":"<table class=\"half\">\n<thead>\n\t<tr><th>IDX</th><th>NAME </th></tr>\n</thead>\n<tbody>\n\t<tr><td>1</td><td>A</td></tr>\n\t<tr><td>1</td><td>B</td></tr>\n\t<tr><td>1</td><td>C</td></tr>\n\t<tr><td>2</td><td>B</td></tr>\n\t<tr><td>2</td><td>D</td></tr>\n</tbody>\n</table>\n<p>위 테이블을 아래와 같이 출력하고 싶다.</p>\n<table class=\"half\">\n<thead>\n\t<tr><th>IDX</th><th>NAME </th></tr>\n</thead>\n<tbody>\n\t<tr><td>1</td><td>A,B,C</td></tr>\n\t<tr><td>2</td><td>B,D</td></tr>\t\n</tbody>\n</table> \n<p><br/><br/></p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">SELECT</span> \n\t<span class=\"hljs-keyword\">DISTINCT</span> IDX,\n\t<span class=\"hljs-keyword\">STUFF</span>\n\t( (\n\t\t<span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-string\">','</span> + <span class=\"hljs-keyword\">NAME</span> <span class=\"hljs-keyword\">FROM</span> TB_NAME A <span class=\"hljs-keyword\">WHERE</span> A.IDX = B.IDX\n\t\t<span class=\"hljs-keyword\">FOR</span> <span class=\"hljs-keyword\">XML</span> <span class=\"hljs-keyword\">PATH</span>(<span class=\"hljs-string\">''</span>)\n\t),<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>,<span class=\"hljs-string\">''</span>) <span class=\"hljs-keyword\">AS</span> <span class=\"hljs-keyword\">NAME</span>\n<span class=\"hljs-keyword\">FROM</span> TB_NAME B\n</code></pre>\n<p>STUFF(STRING,1,1,’’) - 맨 앞 문자 한개 제거</p>\n<h1>STUFF 함수</h1>\n<p><a href=\"https://docs.microsoft.com/ko-kr/sql/t-sql/functions/stuff-transact-sql\">참고페이지</a></p>\n<p>STUFF ( character_expression , start , length , replaceWith_expression )</p>\n<table>\n<thead>\n\t<tr><th>인수</th><th>설명</th></tr>\n</thead>\n<tbody>\n\t<tr><td>start</td><td>삭제 및 삽입 시작 위치, 0, 음수면 NULL이 반환된다.</td></tr>\n\t<tr><td>length</td><td>삭제 할 문자 수 지정, 0, 음수면 NULL이 반환된다.</td></tr>\t\n\t<tr><td>replaceWith_expression </td><td>''이면 아무것도 삽입하지 않고 문자를 제거</td></tr>\t\n</tbody>\n</table>\n","updatedAt":"2020-01-22T18:22:31.380Z"}